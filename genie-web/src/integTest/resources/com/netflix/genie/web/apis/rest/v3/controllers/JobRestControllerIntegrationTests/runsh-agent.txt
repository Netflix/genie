#!/usr/bin/env bash

#
# Generated by Genie for job: JOB_ID_PLACEHOLDER
#

# Error out if any command fails
set -o errexit
# Error out if any command in a pipeline fails
set -o pipefail
# Error out if unknown variable is used
set -o nounset


# Locally-generated environment variables

export GENIE_JOB_DIR="TEST_GENIE_JOB_WORKING_DIR_PLACEHOLDER"

export GENIE_APPLICATION_DIR="${GENIE_JOB_DIR}/genie/applications"

export GENIE_COMMAND_DIR="${GENIE_JOB_DIR}/genie/command/cmd1"

export GENIE_CLUSTER_DIR="${GENIE_JOB_DIR}/genie/cluster/cluster1"

export __GENIE_SETUP_LOG_FILE="${GENIE_JOB_DIR}/genie/logs/setup.log"

export __GENIE_ENVIRONMENT_DUMP_FILE="${GENIE_JOB_DIR}/genie/logs/env.log"


# Server-provided environment variables

export GENIE_CLUSTER_ID="cluster1"

export GENIE_CLUSTER_NAME="Local laptop"

export GENIE_CLUSTER_TAGS="localhost"

export GENIE_COMMAND_ID="cmd1"

export GENIE_COMMAND_NAME="Unix Bash command"

export GENIE_COMMAND_TAGS="bash"

export GENIE_JOB_GROUPING="Workflow.Foo"

export GENIE_JOB_GROUPING_INSTANCE="Workflow.Foo_Step.Blah-2020021919:12:34.000_1"

export GENIE_JOB_ID="JOB_ID_PLACEHOLDER"

export GENIE_JOB_MEMORY="1024"

export GENIE_JOB_NAME="List * ... Directories bash job"

export GENIE_JOB_TAGS="aTag,zTag"

export GENIE_REQUESTED_CLUSTER_TAGS="[[localhost]]"

export GENIE_REQUESTED_CLUSTER_TAGS_0="localhost"

export GENIE_REQUESTED_COMMAND_TAGS="bash"

export GENIE_USER="genie"

export GENIE_USER_GROUP=""

export GENIE_VERSION="4"


echo Setup begins: `date '+%Y-%m-%d %H:%M:%S'` >> ${__GENIE_SETUP_LOG_FILE}

echo "Sourcing setup script for application app1" >> ${__GENIE_SETUP_LOG_FILE}
source ${GENIE_JOB_DIR}/genie/applications/app1/genie_setup.sh 2>&1 >> ${__GENIE_SETUP_LOG_FILE}

echo "Sourcing setup script for application app2" >> ${__GENIE_SETUP_LOG_FILE}
source ${GENIE_JOB_DIR}/genie/applications/app2/genie_setup.sh 2>&1 >> ${__GENIE_SETUP_LOG_FILE}

echo "Sourcing setup script for cluster cluster1" >> ${__GENIE_SETUP_LOG_FILE}
source ${GENIE_JOB_DIR}/genie/cluster/cluster1/genie_setup.sh 2>&1 >> ${__GENIE_SETUP_LOG_FILE}

echo "Sourcing setup script for command cmd1" >> ${__GENIE_SETUP_LOG_FILE}
source ${GENIE_JOB_DIR}/genie/command/cmd1/genie_setup.sh 2>&1 >> ${__GENIE_SETUP_LOG_FILE}

echo "Sourcing setup script for job JOB_ID_PLACEHOLDER" >> ${__GENIE_SETUP_LOG_FILE}
source ${GENIE_JOB_DIR}/genie_setup.sh 2>&1 >> ${__GENIE_SETUP_LOG_FILE}

echo Setup end: `date '+%Y-%m-%d %H:%M:%S'` >> ${__GENIE_SETUP_LOG_FILE}

# Dump environment post-setup
env | sort > ${__GENIE_ENVIRONMENT_DUMP_FILE}

# Launch the command
/bin/bash -c 'sleep 1 && echo hello world'
