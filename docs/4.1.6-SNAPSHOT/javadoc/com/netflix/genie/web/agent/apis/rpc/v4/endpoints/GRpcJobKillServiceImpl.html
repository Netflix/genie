<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>GRpcJobKillServiceImpl (genie 4.1.6-SNAPSHOT API)</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="GRpcJobKillServiceImpl (genie 4.1.6-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcHeartBeatServiceImpl.html" title="class in com.netflix.genie.web.agent.apis.rpc.v4.endpoints"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobServiceImpl.html" title="class in com.netflix.genie.web.agent.apis.rpc.v4.endpoints"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../../../index.html?com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobKillServiceImpl.html" target="_top">Frames</a></li>
<li><a href="GRpcJobKillServiceImpl.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.netflix.genie.web.agent.apis.rpc.v4.endpoints</div>
<h2 title="Class GRpcJobKillServiceImpl" class="title">Class GRpcJobKillServiceImpl</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.netflix.genie.proto.JobKillServiceGrpc.JobKillServiceImplBase</li>
<li>
<ul class="inheritance">
<li>com.netflix.genie.web.agent.apis.rpc.v4.endpoints.GRpcJobKillServiceImpl</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../../../../../com/netflix/genie/web/services/JobKillService.html" title="interface in com.netflix.genie.web.services">JobKillService</a>, io.grpc.BindableService</dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">GRpcJobKillServiceImpl</span>
extends com.netflix.genie.proto.JobKillServiceGrpc.JobKillServiceImplBase
implements <a href="../../../../../../../../../com/netflix/genie/web/services/JobKillService.html" title="interface in com.netflix.genie.web.services">JobKillService</a></pre>
<div class="block">Implementation of <a href="../../../../../../../../../com/netflix/genie/web/services/JobKillService.html" title="interface in com.netflix.genie.web.services"><code>JobKillService</code></a> which uses parked gRPC requests to tell the agent to
 shutdown via a user kill request if the job is in an active state.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>4.0.0</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobKillServiceImpl.html#GRpcJobKillServiceImpl-com.netflix.genie.web.data.services.DataServices-com.netflix.genie.web.agent.services.AgentRoutingService-com.netflix.genie.web.services.RequestForwardingService-">GRpcJobKillServiceImpl</a></span>(<a href="../../../../../../../../../com/netflix/genie/web/data/services/DataServices.html" title="class in com.netflix.genie.web.data.services">DataServices</a>&nbsp;dataServices,
                      <a href="../../../../../../../../../com/netflix/genie/web/agent/services/AgentRoutingService.html" title="interface in com.netflix.genie.web.agent.services">AgentRoutingService</a>&nbsp;agentRoutingService,
                      <a href="../../../../../../../../../com/netflix/genie/web/services/RequestForwardingService.html" title="interface in com.netflix.genie.web.services">RequestForwardingService</a>&nbsp;requestForwardingService)</code>
<div class="block">Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobKillServiceImpl.html#cleanupOrphanedObservers--">cleanupOrphanedObservers</a></span>()</code>
<div class="block">Remove orphaned kill observers from local map.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobKillServiceImpl.html#isStreamObserverCancelled-io.grpc.stub.StreamObserver-">isStreamObserverCancelled</a></span>(io.grpc.stub.StreamObserver&lt;com.netflix.genie.proto.JobKillRegistrationResponse&gt;&nbsp;observer)</code>
<div class="block">Converts StreamObserver into ServerCallStreamObserver in order to tell
 whether the observer is cancelled or not.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobKillServiceImpl.html#killJob-java.lang.String-java.lang.String-javax.servlet.http.HttpServletRequest-">killJob</a></span>(java.lang.String&nbsp;jobId,
       java.lang.String&nbsp;reason,
       javax.servlet.http.HttpServletRequest&nbsp;request)</code>
<div class="block">Kill the job with the given id if possible.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobKillServiceImpl.html#registerForKillNotification-com.netflix.genie.proto.JobKillRegistrationRequest-io.grpc.stub.StreamObserver-">registerForKillNotification</a></span>(com.netflix.genie.proto.JobKillRegistrationRequest&nbsp;request,
                           io.grpc.stub.StreamObserver&lt;com.netflix.genie.proto.JobKillRegistrationResponse&gt;&nbsp;responseObserver)</code>
<div class="block">Register to be notified when a kill request for the job is received.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.com.netflix.genie.proto.JobKillServiceGrpc.JobKillServiceImplBase">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.netflix.genie.proto.JobKillServiceGrpc.JobKillServiceImplBase</h3>
<code>bindService</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="GRpcJobKillServiceImpl-com.netflix.genie.web.data.services.DataServices-com.netflix.genie.web.agent.services.AgentRoutingService-com.netflix.genie.web.services.RequestForwardingService-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>GRpcJobKillServiceImpl</h4>
<pre>public&nbsp;GRpcJobKillServiceImpl(<a href="../../../../../../../../../com/netflix/genie/web/data/services/DataServices.html" title="class in com.netflix.genie.web.data.services">DataServices</a>&nbsp;dataServices,
                              <a href="../../../../../../../../../com/netflix/genie/web/agent/services/AgentRoutingService.html" title="interface in com.netflix.genie.web.agent.services">AgentRoutingService</a>&nbsp;agentRoutingService,
                              <a href="../../../../../../../../../com/netflix/genie/web/services/RequestForwardingService.html" title="interface in com.netflix.genie.web.services">RequestForwardingService</a>&nbsp;requestForwardingService)</pre>
<div class="block">Constructor.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataServices</code> - The <a href="../../../../../../../../../com/netflix/genie/web/data/services/DataServices.html" title="class in com.netflix.genie.web.data.services"><code>DataServices</code></a> instance to use</dd>
<dd><code>agentRoutingService</code> - The <a href="../../../../../../../../../com/netflix/genie/web/agent/services/AgentRoutingService.html" title="interface in com.netflix.genie.web.agent.services"><code>AgentRoutingService</code></a> instance to use to find where agents are
                                 connected</dd>
<dd><code>requestForwardingService</code> - The service to use to forward requests to other Genie nodes</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="registerForKillNotification-com.netflix.genie.proto.JobKillRegistrationRequest-io.grpc.stub.StreamObserver-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>registerForKillNotification</h4>
<pre>public&nbsp;void&nbsp;registerForKillNotification(com.netflix.genie.proto.JobKillRegistrationRequest&nbsp;request,
                                        io.grpc.stub.StreamObserver&lt;com.netflix.genie.proto.JobKillRegistrationResponse&gt;&nbsp;responseObserver)</pre>
<div class="block">Register to be notified when a kill request for the job is received.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code>registerForKillNotification</code>&nbsp;in class&nbsp;<code>com.netflix.genie.proto.JobKillServiceGrpc.JobKillServiceImplBase</code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - Request to register for getting notified when server gets a job kill request.</dd>
<dd><code>responseObserver</code> - The response observer</dd>
</dl>
</li>
</ul>
<a name="killJob-java.lang.String-java.lang.String-javax.servlet.http.HttpServletRequest-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>killJob</h4>
<pre>@Retryable(value={<a href="../../../../../../../../../com/netflix/genie/common/internal/exceptions/unchecked/GenieInvalidStatusException.html" title="class in com.netflix.genie.common.internal.exceptions.unchecked">GenieInvalidStatusException.class</a>,<a href="../../../../../../../../../com/netflix/genie/common/exceptions/GenieServerException.html" title="class in com.netflix.genie.common.exceptions">GenieServerException.class</a>},
           backoff=@Backoff(delay=1000L))
public&nbsp;void&nbsp;killJob(java.lang.String&nbsp;jobId,
                                                                                                                                               java.lang.String&nbsp;reason,
                                                                                                                                               @Nullable
                                                                                                                                               javax.servlet.http.HttpServletRequest&nbsp;request)
                                                                                                                                        throws <a href="../../../../../../../../../com/netflix/genie/common/internal/exceptions/unchecked/GenieJobNotFoundException.html" title="class in com.netflix.genie.common.internal.exceptions.unchecked">GenieJobNotFoundException</a>,
                                                                                                                                               <a href="../../../../../../../../../com/netflix/genie/common/exceptions/GenieServerException.html" title="class in com.netflix.genie.common.exceptions">GenieServerException</a></pre>
<div class="block">Kill the job with the given id if possible.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../../../../com/netflix/genie/web/services/JobKillService.html#killJob-java.lang.String-java.lang.String-javax.servlet.http.HttpServletRequest-">killJob</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../../../../com/netflix/genie/web/services/JobKillService.html" title="interface in com.netflix.genie.web.services">JobKillService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>jobId</code> - id of job to kill</dd>
<dd><code>reason</code> - brief reason for requesting the job be killed</dd>
<dd><code>request</code> - The optional <code>HttpServletRequest</code> information if the request needs to be forwarded</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../../../com/netflix/genie/common/internal/exceptions/unchecked/GenieJobNotFoundException.html" title="class in com.netflix.genie.common.internal.exceptions.unchecked">GenieJobNotFoundException</a></code> - When a job identified by jobId can't be found in the system</dd>
<dd><code><a href="../../../../../../../../../com/netflix/genie/common/exceptions/GenieServerException.html" title="class in com.netflix.genie.common.exceptions">GenieServerException</a></code> - if there is an unrecoverable error in the internal state of the Genie cluster</dd>
</dl>
</li>
</ul>
<a name="cleanupOrphanedObservers--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cleanupOrphanedObservers</h4>
<pre>@Scheduled(fixedDelay=30000L,
           initialDelay=30000L)
public&nbsp;void&nbsp;cleanupOrphanedObservers()</pre>
<div class="block">Remove orphaned kill observers from local map.
 <p>
 The logic as currently implemented is to have the Agent, once handshake is complete, open a connection to
 the server which results in parking a response observer in the map stored in this implementation. Upon receiving
 a kill request for the correct job this class will use the observer to send the "response" to the agent which
 will begin shut down process. The issue is that if the agent disconnects from this server the server will never
 realize it's gone and these observers will build up in the map in memory forever. This method will periodically
 go through the map and determine if the observers are still valid and remove any that aren't.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd>"GRpcAgentJobKillServiceImpl"</dd>
</dl>
</li>
</ul>
<a name="isStreamObserverCancelled-io.grpc.stub.StreamObserver-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>isStreamObserverCancelled</h4>
<pre>protected&nbsp;boolean&nbsp;isStreamObserverCancelled(io.grpc.stub.StreamObserver&lt;com.netflix.genie.proto.JobKillRegistrationResponse&gt;&nbsp;observer)</pre>
<div class="block">Converts StreamObserver into ServerCallStreamObserver in order to tell
 whether the observer is cancelled or not.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>observer</code> - Observer for which we would check the status</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Boolean value: true if observer has status CANCELLED</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcHeartBeatServiceImpl.html" title="class in com.netflix.genie.web.agent.apis.rpc.v4.endpoints"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../../../../com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobServiceImpl.html" title="class in com.netflix.genie.web.agent.apis.rpc.v4.endpoints"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../../../index.html?com/netflix/genie/web/agent/apis/rpc/v4/endpoints/GRpcJobKillServiceImpl.html" target="_top">Frames</a></li>
<li><a href="GRpcJobKillServiceImpl.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
