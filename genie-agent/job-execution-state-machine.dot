/*
 *
 *  Copyright 2018 Netflix, Inc.
 *
 *     Licensed under the Apache License, Version 2.0 (the "License");
 *     you may not use this file except in compliance with the License.
 *     You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 *     Unless required by applicable law or agreed to in writing, software
 *     distributed under the License is distributed on an "AS IS" BASIS,
 *     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *     See the License for the specific language governing permissions and
 *     limitations under the License.
 *
 */
//
// Generated with genie-agent.jar info --state-machine
//
digraph state_machine {
  // States
  START_HEARTBEAT_SERVICE [label=START_HEARTBEAT_SERVICE  penwidth=3.0]
  START_FILE_STREAM_SERVICE [label=START_FILE_STREAM_SERVICE  penwidth=3.0]
  RESERVE_JOB_ID [label=RESERVE_JOB_ID  penwidth=3.0]
  STOP_KILL_SERVICE [label=STOP_KILL_SERVICE  ]
  POST_EXECUTION_MANIFEST_REFRESH [label=POST_EXECUTION_MANIFEST_REFRESH  ]
  WAIT_JOB_COMPLETION [label=WAIT_JOB_COMPLETION  penwidth=3.0]
  POST_LAUNCH_MANIFEST_REFRESH [label=POST_LAUNCH_MANIFEST_REFRESH  ]
  CREATE_JOB_SCRIPT [label=CREATE_JOB_SCRIPT  penwidth=3.0]
  CREATE_JOB_DIRECTORY [label=CREATE_JOB_DIRECTORY  penwidth=3.0]
  READY [label=READY shape=diamond ]
  DOWNLOAD_DEPENDENCIES [label=DOWNLOAD_DEPENDENCIES  penwidth=3.0]
  ARCHIVE [label=ARCHIVE  ]
  LAUNCH_JOB [label=LAUNCH_JOB  penwidth=3.0]
  CLAIM_JOB [label=CLAIM_JOB  penwidth=3.0]
  SET_STATUS_RUNNING [label=SET_STATUS_RUNNING  penwidth=3.0]
  STOP_FILES_STREAM_SERVICE [label=STOP_FILES_STREAM_SERVICE  ]
  CONFIGURE_EXECUTION [label=CONFIGURE_EXECUTION  penwidth=3.0]
  SET_STATUS_FINAL [label=SET_STATUS_FINAL  penwidth=3.0]
  CLEAN [label=CLEAN  ]
  POST_SETUP_MANIFEST_REFRESH [label=POST_SETUP_MANIFEST_REFRESH  ]
  OBTAIN_JOB_SPECIFICATION [label=OBTAIN_JOB_SPECIFICATION  penwidth=3.0]
  SHUTDOWN [label=SHUTDOWN  ]
  SET_STATUS_INIT [label=SET_STATUS_INIT  penwidth=3.0]
  DETERMINE_FINAL_STATUS [label=DETERMINE_FINAL_STATUS  penwidth=3.0]
  STOP_HEARTBEAT_SERVICE [label=STOP_HEARTBEAT_SERVICE  ]
  HANDSHAKE [label=HANDSHAKE  penwidth=3.0]
  INITIALIZE_AGENT [label=INITIALIZE_AGENT  penwidth=3.0]
  RELOCATE_LOG [label=RELOCATE_LOG  ]
  DONE [label=DONE shape=rectangle ]
  LOG_EXECUTION_ERRORS [label=LOG_EXECUTION_ERRORS  ]
  START_KILL_SERVICE [label=START_KILL_SERVICE  penwidth=3.0]
  // Transitions
  READY -> INITIALIZE_AGENT [label="START"]
  SHUTDOWN -> DONE [label="PROCEED"]
  INITIALIZE_AGENT -> HANDSHAKE [label="PROCEED"]
  HANDSHAKE -> CONFIGURE_EXECUTION [label="PROCEED"]
  CONFIGURE_EXECUTION -> RESERVE_JOB_ID [label="PROCEED"]
  RESERVE_JOB_ID -> OBTAIN_JOB_SPECIFICATION [label="PROCEED"]
  OBTAIN_JOB_SPECIFICATION -> CREATE_JOB_DIRECTORY [label="PROCEED"]
  CREATE_JOB_DIRECTORY -> RELOCATE_LOG [label="PROCEED"]
  RELOCATE_LOG -> CLAIM_JOB [label="PROCEED"]
  CLAIM_JOB -> START_HEARTBEAT_SERVICE [label="PROCEED"]
  START_HEARTBEAT_SERVICE -> START_KILL_SERVICE [label="PROCEED"]
  START_KILL_SERVICE -> START_FILE_STREAM_SERVICE [label="PROCEED"]
  START_FILE_STREAM_SERVICE -> SET_STATUS_INIT [label="PROCEED"]
  SET_STATUS_INIT -> CREATE_JOB_SCRIPT [label="PROCEED"]
  CREATE_JOB_SCRIPT -> DOWNLOAD_DEPENDENCIES [label="PROCEED"]
  DOWNLOAD_DEPENDENCIES -> POST_SETUP_MANIFEST_REFRESH [label="PROCEED"]
  POST_SETUP_MANIFEST_REFRESH -> LAUNCH_JOB [label="PROCEED"]
  LAUNCH_JOB -> POST_LAUNCH_MANIFEST_REFRESH [label="PROCEED"]
  POST_LAUNCH_MANIFEST_REFRESH -> SET_STATUS_RUNNING [label="PROCEED"]
  SET_STATUS_RUNNING -> WAIT_JOB_COMPLETION [label="PROCEED"]
  WAIT_JOB_COMPLETION -> POST_EXECUTION_MANIFEST_REFRESH [label="PROCEED"]
  POST_EXECUTION_MANIFEST_REFRESH -> DETERMINE_FINAL_STATUS [label="PROCEED"]
  DETERMINE_FINAL_STATUS -> SET_STATUS_FINAL [label="PROCEED"]
  SET_STATUS_FINAL -> STOP_KILL_SERVICE [label="PROCEED"]
  STOP_KILL_SERVICE -> LOG_EXECUTION_ERRORS [label="PROCEED"]
  LOG_EXECUTION_ERRORS -> ARCHIVE [label="PROCEED"]
  ARCHIVE -> STOP_HEARTBEAT_SERVICE [label="PROCEED"]
  STOP_HEARTBEAT_SERVICE -> STOP_FILES_STREAM_SERVICE [label="PROCEED"]
  STOP_FILES_STREAM_SERVICE -> CLEAN [label="PROCEED"]
  CLEAN -> SHUTDOWN [label="PROCEED"]
  // Skip transitions
  INITIALIZE_AGENT -> WAIT_JOB_COMPLETION [style=dotted]
  HANDSHAKE -> WAIT_JOB_COMPLETION [style=dotted]
  CONFIGURE_EXECUTION -> WAIT_JOB_COMPLETION [style=dotted]
  RESERVE_JOB_ID -> WAIT_JOB_COMPLETION [style=dotted]
  OBTAIN_JOB_SPECIFICATION -> WAIT_JOB_COMPLETION [style=dotted]
  CREATE_JOB_DIRECTORY -> WAIT_JOB_COMPLETION [style=dotted]
  RELOCATE_LOG -> WAIT_JOB_COMPLETION [style=dotted]
  CLAIM_JOB -> WAIT_JOB_COMPLETION [style=dotted]
  START_HEARTBEAT_SERVICE -> WAIT_JOB_COMPLETION [style=dotted]
  START_KILL_SERVICE -> WAIT_JOB_COMPLETION [style=dotted]
  START_FILE_STREAM_SERVICE -> WAIT_JOB_COMPLETION [style=dotted]
  SET_STATUS_INIT -> WAIT_JOB_COMPLETION [style=dotted]
  CREATE_JOB_SCRIPT -> WAIT_JOB_COMPLETION [style=dotted]
  DOWNLOAD_DEPENDENCIES -> WAIT_JOB_COMPLETION [style=dotted]
  POST_SETUP_MANIFEST_REFRESH -> WAIT_JOB_COMPLETION [style=dotted]
  LAUNCH_JOB -> WAIT_JOB_COMPLETION [style=dotted]
  POST_LAUNCH_MANIFEST_REFRESH -> WAIT_JOB_COMPLETION [style=dotted]
  // Retry transitions
  HANDSHAKE -> HANDSHAKE [style=dashed label="3 retries"]
  RESERVE_JOB_ID -> RESERVE_JOB_ID [style=dashed label="3 retries"]
  OBTAIN_JOB_SPECIFICATION -> OBTAIN_JOB_SPECIFICATION [style=dashed label="3 retries"]
  CLAIM_JOB -> CLAIM_JOB [style=dashed label="3 retries"]
  SET_STATUS_INIT -> SET_STATUS_INIT [style=dashed label="3 retries"]
  SET_STATUS_RUNNING -> SET_STATUS_RUNNING [style=dashed label="3 retries"]
  SET_STATUS_FINAL -> SET_STATUS_FINAL [style=dashed label="3 retries"]
}
